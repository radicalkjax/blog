<!-- Language Switcher Component -->
<div class="language-switcher">
  <button type="button" class="language-switcher-toggle" aria-label="Language selection" aria-expanded="false">
    <i class="fas fa-globe"></i>
    <span class="language-code">{{ site.active_lang | default: site.default_lang | upcase }}</span>
  </button>
  <ul class="language-switcher-menu">
    {%- for lang in site.languages -%}
      <li class="language-option {% if lang == site.active_lang %}active{% endif %}">
        {%- if lang == site.active_lang -%}
          <span class="language-link current">
            {{ lang | upcase }}
            <i class="fas fa-check"></i>
          </span>
        {%- else -%}
          <a href="{% if lang == site.default_lang %}{{ site.baseurl }}{{ page.url }}{% else %}{{ site.baseurl }}/{{ lang }}{{ page.url }}{% endif %}" class="language-link" hreflang="{{ lang }}">
            {{ lang | upcase }}
          </a>
        {%- endif -%}
      </li>
    {%- endfor -%}
  </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const toggle = document.querySelector('.language-switcher-toggle');
  const menu = document.querySelector('.language-switcher-menu');

  if (toggle && menu) {
    // Toggle menu on click
    toggle.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();

      const isOpen = menu.classList.contains('show');

      if (isOpen) {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      } else {
        menu.classList.add('show');
        toggle.classList.add('active');
        toggle.setAttribute('aria-expanded', 'true');
      }
    });

    // Close menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.language-switcher')) {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      }
    });

    // Close menu when selecting a language
    const languageLinks = document.querySelectorAll('.language-link');
    languageLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      });
    });
  }
});
</script>