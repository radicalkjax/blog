<!-- Language Switcher Component -->
<div class="language-switcher">
  <button class="language-switcher-toggle" aria-label="Language selection" aria-expanded="false">
    <i class="fas fa-globe"></i>
    <span class="language-code">{{ site.active_lang | default: site.default_lang | upcase }}</span>
  </button>
  <ul class="language-switcher-menu" role="list">
    {% for lang in site.languages %}
      <li class="language-option {% if lang == site.active_lang %}active{% endif %}" role="listitem">
        {% if lang == site.active_lang %}
          <span class="language-link current">
            {{ lang | upcase }}
            <i class="fas fa-check"></i>
          </span>
        {% else %}
          <a {% static_href %}href="{% if lang == site.default_lang %}{{ site.baseurl }}{{ page.url }}{% else %}{{ site.baseurl }}/{{ lang }}{{ page.url }}{% endif %}"{% endstatic_href %} class="language-link" hreflang="{{ lang }}">
            {{ lang | upcase }}
          </a>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
</div>

<style>
.language-switcher {
  position: relative;
  display: inline-block;
  vertical-align: middle;
  margin-left: 10px;
}

.language-switcher-toggle {
  cursor: pointer;
  padding: 2px 6px;
  border: 1px solid #ffffff;
  border-radius: 3px;
  background-color: transparent;
  color: #ffffff;
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s ease;
  vertical-align: middle;
  line-height: 1;
  height: 20px;
}

.language-switcher-toggle:hover {
  background-color: rgba(255, 255, 255, 0.1);
  transform: translateY(-1px);
}

.language-switcher-toggle.active {
  background-color: rgba(255, 255, 255, 0.15);
}

.language-code {
  font-weight: 500;
}

.language-switcher-menu {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: 4px;
  min-width: 60px;
  background-color: #1a1a1a;
  border: 1px solid #ffffff;
  border-radius: 3px;
  list-style: none;
  padding: 0;
  margin: 4px 0 0 0;
  display: none;
  z-index: 1000;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.language-switcher-menu.show {
  display: block;
}

.language-option {
  margin: 0;
  padding: 0;
}

.language-link {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 10px;
  color: #ffffff;
  text-decoration: none;
  font-family: 'DM Mono', monospace;
  font-size: 11px;
  transition: background-color 0.2s ease;
}

.language-link:hover {
  background-color: rgba(109, 16, 90, 0.3);
}

.language-link.current {
  background-color: rgba(109, 16, 90, 0.5);
  cursor: default;
}

.language-option + .language-option {
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.language-link i {
  font-size: 9px;
}

/* Mobile responsive */
@media (max-width: 768px) {
  .language-switcher {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
  }
  
  .language-switcher-toggle {
    background-color: #6d105a;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  }
  
  .language-switcher-menu {
    bottom: 100%;
    top: auto;
    margin-bottom: 8px;
    margin-top: 0;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const toggle = document.querySelector('.language-switcher-toggle');
  const menu = document.querySelector('.language-switcher-menu');
  
  if (toggle && menu) {
    // Toggle menu on click
    toggle.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      const isOpen = menu.classList.contains('show');
      
      if (isOpen) {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      } else {
        menu.classList.add('show');
        toggle.classList.add('active');
        toggle.setAttribute('aria-expanded', 'true');
      }
    });
    
    // Close menu when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.language-switcher')) {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      }
    });
    
    // Close menu when selecting a language
    const languageLinks = document.querySelectorAll('.language-link');
    languageLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        menu.classList.remove('show');
        toggle.classList.remove('active');
        toggle.setAttribute('aria-expanded', 'false');
      });
    });
  }
});
</script>